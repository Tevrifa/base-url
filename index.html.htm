<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- üì± ‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æµ‡Æü‡Æø‡Æµ‡ÆÆ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ© ‡ÆÆ‡ØÜ‡Æü‡Øç‡Æü‡Ææ ‡Æü‡Øá‡Æï‡Øç -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Quick Order App</title>
    
    <!-- ‡Æ®‡Æµ‡ØÄ‡Æ© Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #00a550; /* ‡Æ™‡Æø‡Æ∞‡Æ§‡Ææ‡Æ© ‡Æ™‡Æö‡Øç‡Æö‡Øà ‡Æ®‡Æø‡Æ±‡ÆÆ‡Øç */
            --bg-color: #f4f5f8;
            --white: #ffffff;
            --text-dark: #2d3436;
            --text-light: #636e72;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --unavailable: #b9b9b9; /* ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡Ææ‡Æ§ ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡Ææ‡Æ© ‡Æ®‡Æø‡Æ±‡ÆÆ‡Øç */
        }

        * {
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent; 
        }

        body {
            margin: 0;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
        }

        .app-container {
            width: 100%;
            max-width: 480px; 
            background: var(--white);
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            padding-bottom: 100px; 
        }

        /* --- Header --- */
        .header {
            background: var(--white);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #f0f0f0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
        }

        .shop-info h1 {
            margin: 0;
            font-size: 18px;
            color: var(--text-dark);
            font-weight: 700;
        }

        .shop-info p {
            margin: 2px 0 0;
            font-size: 11px;
            color: var(--primary-color);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #languageSelector {
            padding: 5px 8px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 12px;
            background: #f9f9f9;
        }

        .status-dot {
            height: 10px; width: 10px;
            background-color: #2ecc71;
            border-radius: 50%;
            display: inline-block;
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2);
        }

        /* --- Menu List --- */
        .menu-container {
            padding: 15px;
            animation: fadeIn 0.5s ease-in-out;
        }

        .menu-card {
            background: var(--white);
            border-radius: 16px;
            padding: 12px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: var(--shadow);
            border: 1px solid #f8f8f8;
            transition: transform 0.2s;
        }
        
        .menu-card.unavailable {
            opacity: 0.5;
            pointer-events: none;
        }

        .menu-card:not(.unavailable):active {
            transform: scale(0.98); 
        }

        .item-image {
            width: 75px;
            height: 75px;
            border-radius: 12px;
            object-fit: cover;
            background-color: #eee;
        }

        .item-details { flex: 1; }

        .item-name {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
            display: block;
        }

        .item-price {
            font-size: 14px;
            color: var(--text-light);
            font-weight: 500;
        }

        /* --- Add Button --- */
        .add-btn-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
            position: relative; 
        }

        .qty-controls {
            display: flex;
            align-items: center;
            background: var(--white);
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .qty-btn {
            background: var(--white);
            border: none;
            color: var(--primary-color);
            font-weight: 700;
            font-size: 16px;
            width: 25px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .unavailable-tag {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: var(--unavailable);
            color: white;
            padding: 5px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }


        .qty-val {
            font-size: 13px;
            font-weight: 600;
            width: 20px;
            text-align: center;
        }

        /* --- Floating Bottom Cart --- */
        .floating-cart {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 440px;
            background-color: var(--text-dark);
            color: var(--white);
            border-radius: 12px;
            padding: 15px 20px;
            display: none; 
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 500;
            cursor: pointer;
            animation: slideUp 0.3s ease-out;
        }

        .cart-text strong { font-size: 15px; }
        .cart-text span { font-size: 11px; opacity: 0.8; display: block; }
        
        .cart-arrow { font-size: 18px; font-weight: bold; color: var(--primary-color); }

        /* --- Modal (Checkout) --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            display: none;
            align-items: flex-end; 
            justify-content: center;
            backdrop-filter: blur(3px);
        }

        .modal-sheet {
            background: var(--white);
            width: 100%;
            max-width: 480px;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
            padding: 25px;
            animation: slideUpSheet 0.3s ease-out;
        }

        .modal-title { font-size: 18px; font-weight: 700; margin-bottom: 20px; }

        .input-group { margin-bottom: 15px; }
        .input-label { font-size: 12px; color: var(--text-light); margin-bottom: 5px; display: block; }
        
        .input-field {
            width: 100%;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            background: #fcfcfc;
            outline: none;
        }
        .input-field:focus { border-color: var(--primary-color); background: #fff; }

        .place-order-btn {
            width: 100%;
            padding: 15px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            margin-top: 10px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 165, 80, 0.3);
            transition: background 0.3s;
        }

        .place-order-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* --- Loading / States --- */
        .loading-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 60vh;
            color: var(--text-light);
            font-size: 14px;
        }
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes slideUp { from { transform: translate(-50%, 100%); opacity: 0; } to { transform: translate(-50%, -10px); opacity: 1; } }
        @keyframes slideUpSheet { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

<div class="app-container">
    <!-- ‡Æ§‡Æ≤‡Øà‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø -->
    <div class="header">
        <div class="shop-info">
            <h1 id="shopTitle" data-key="loading">‡Æè‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...</h1>
            <p data-key="onlineOrder">‡ÆÜ‡Æ©‡Øç‡Æ≤‡Øà‡Æ©‡Øç ‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øç</p>
        </div>
        <div class="header-controls">
            <select id="languageSelector" onchange="setLanguage(this.value)">
                <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
                <option value="en">English</option>
                <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
            </select>
            <div class="status-dot"></div>
        </div>
    </div>

    <!-- ‡ÆÆ‡ØÜ‡Æ©‡ØÅ ‡Æ™‡Æï‡ØÅ‡Æ§‡Æø -->
    <div id="menuContainer" class="menu-container">
        <div class="loading-screen">
            <div class="spinner"></div>
            <span data-key="loadingMenu">‡ÆÆ‡ØÜ‡Æ©‡ØÅ‡Æµ‡Øà ‡Æè‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ... (Loading Menu)</span>
        </div>
    </div>
</div>

<!-- Cart ‡Æ™‡Æü‡Øç‡Æü‡Æ©‡Øç (‡Æï‡ØÄ‡Æ¥‡Øá ‡ÆÆ‡Æø‡Æ§‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç) -->
<div class="floating-cart" id="floatingCart" onclick="openCheckout()">
    <div class="cart-text">
        <span id="itemCount">0 Items</span>
        <strong id="totalPrice">‚Çπ0</strong>
    </div>
    <div class="cart-arrow" data-key="continue">‡Æ§‡Øä‡Æü‡Æ∞‡Æµ‡ØÅ‡ÆÆ‡Øç &rarr;</div>
</div>

<!-- Checkout Modal (‡ÆÆ‡Æ±‡Øà‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ) -->
<div class="modal-overlay" id="checkoutModal">
    <div class="modal-sheet">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <div class="modal-title" data-key="completeOrder">‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øà ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç</div>
            <div onclick="closeCheckout()" style="font-size:24px; cursor:pointer; padding:10px;">&times;</div>
        </div>
        
        <div class="input-group">
            <label class="input-label" data-key="yourName">‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç</label>
            <input type="text" id="cName" class="input-field" data-key-placeholder="enterName" placeholder="‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç">
        </div>
        <div class="input-group">
            <label class="input-label" data-key="mobileNumber">‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æé‡Æ£‡Øç</label>
            <input type="tel" id="cPhone" class="input-field" data-key-placeholder="enterMobile" placeholder="10 ‡Æá‡Æ≤‡Æï‡Øç‡Æï ‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æé‡Æ£‡Øç">
        </div>
        <div class="input-group">
            <label class="input-label" data-key="address">‡ÆÆ‡ØÅ‡Æï‡Æµ‡Æ∞‡Æø</label>
            <textarea id="cAddress" class="input-field" rows="2" data-key-placeholder="enterAddress" placeholder="‡ÆÖ‡Æ±‡Øà ‡Æé‡Æ£‡Øç, ‡Æ§‡ØÜ‡Æ∞‡ØÅ‡Æ™‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç"></textarea>
        </div>

        <button class="place-order-btn" id="placeOrderBtn" onclick="submitOrder()" data-key="placeOrderBtn">WhatsApp ‡Æµ‡Æ¥‡Æø‡ÆØ‡Ææ‡Æï ‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç</button>
    </div>
</div>

<script>
    // ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è Google Apps Script URL ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
    const scriptURL = "https://script.google.com/macros/s/AKfycby4D0cHOZLeGNWgpZh1phZxvPGz1MsZtuav8KSPI_eMuPCjJgz5j_tNOpsxquqIzyBR/exec"; 
    
    // ‡Æ™‡Æ©‡Øç‡ÆÆ‡Øä‡Æ¥‡Æø ‡ÆÖ‡Æï‡Æ∞‡Ææ‡Æ§‡Æø (Localization Dictionary)
    const translations = {
        ta: {
            loading: "‡Æè‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...", onlineOrder: "‡ÆÜ‡Æ©‡Øç‡Æ≤‡Øà‡Æ©‡Øç ‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øç", loadingMenu: "‡ÆÆ‡ØÜ‡Æ©‡ØÅ‡Æµ‡Øà ‡Æè‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...", 
            items: "‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øç", continue: "‡Æ§‡Øä‡Æü‡Æ∞‡Æµ‡ØÅ‡ÆÆ‡Øç", completeOrder: "‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øà ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç", 
            yourName: "‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç", enterName: "‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æø‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç", mobileNumber: "‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æé‡Æ£‡Øç", 
            enterMobile: "10 ‡Æá‡Æ≤‡Æï‡Øç‡Æï ‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æé‡Æ£‡Øç", address: "‡ÆÆ‡ØÅ‡Æï‡Æµ‡Æ∞‡Æø", enterAddress: "‡ÆÖ‡Æ±‡Øà ‡Æé‡Æ£‡Øç, ‡Æ§‡ØÜ‡Æ∞‡ØÅ‡Æ™‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç",
            placeOrderBtn: "WhatsApp ‡Æµ‡Æ¥‡Æø‡ÆØ‡Ææ‡Æï ‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç", linkError: "‚ùå ‡Æï‡Æü‡Øà ‡Æ≤‡Æø‡Æô‡Øç‡Æï‡Øç ‡Æ§‡Æµ‡Æ±‡Ææ‡Æ©‡Æ§‡ØÅ. Link-‡Æ©‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡Æø‡Æ≤‡Øç ?shopId=your_id ‡Æé‡Æ©‡Øç‡Æ±‡ØÅ ‡Æö‡Øá‡Æ∞‡Øç‡Æ§‡Øç‡Æ§‡ØÅ‡Æ≥‡Øç‡Æ≥‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Ææ ‡Æé‡Æ© ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
            networkError: "‚ùå ‡Æá‡Æ£‡Øà‡Æ™‡Øç‡Æ™‡ØÅ‡Æ™‡Øç ‡Æ™‡Æø‡Æ¥‡Øà. ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç Script URL ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç Deployment Access ('Anyone') ‡Æê ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
            inactiveShop: "‚ö†Ô∏è ‡Æá‡Æ®‡Øç‡Æ§ ‡Æï‡Æü‡Øà ‡Æö‡Øá‡Æµ‡Øà ‡Æ§‡Æ±‡Øç‡Æï‡Ææ‡Æ≤‡Æø‡Æï‡ÆÆ‡Ææ‡Æï ‡Æ®‡Æø‡Æ±‡ØÅ‡Æ§‡Øç‡Æ§‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ.", noItems: "‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øç ‡Æé‡Æ§‡ØÅ‡Æµ‡ØÅ‡ÆÆ‡Øç ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà. MenuData JSON-‡Æê ‡Æö‡Æ∞‡Æø‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
            unavailableTitle: "‚ùå ‡Æ§‡Æ±‡Øç‡Æï‡Ææ‡Æ≤‡Æø‡Æï‡ÆÆ‡Ææ‡Æï ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡Ææ‡Æ§‡Æµ‡Øà", soldOut: "‡Æµ‡Æø‡Æ±‡Øç‡Æ±‡ØÅ ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ", add: "‡Æö‡Øá‡Æ∞‡Øç‡Æï‡Øç‡Æï",
            fillDetailsAlert: "‚ö†Ô∏è ‡Æ§‡ÆØ‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç, ‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç ‡Æé‡Æ£‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡ØÅ‡Æï‡Æµ‡Æ∞‡Æø ‡ÆÜ‡Æï‡Æø‡ÆØ ‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æµ‡Æø‡Æµ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æ®‡Æø‡Æ∞‡Æ™‡Øç‡Æ™‡Æµ‡ØÅ‡ÆÆ‡Øç.",
            submittingOrder: "‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øà‡Æö‡Øç ‡Æö‡ÆÆ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Æø‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ...",
            orderMessageTitle: "*üí• ‡Æ™‡ØÅ‡Æ§‡Æø‡ÆØ ‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øç!* üõµ",
            customer: "*‡Æµ‡Ææ‡Æü‡Æø‡Æï‡Øç‡Æï‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç*", mobile: "*‡ÆÆ‡Øä‡Æ™‡Øà‡Æ≤‡Øç*", orderDetails: "*‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øç ‡Æµ‡Æø‡Æµ‡Æ∞‡ÆÆ‡Øç:*",
            totalBill: "*‡ÆÆ‡Øä‡Æ§‡Øç‡Æ§ ‡Æ™‡Æø‡Æ≤‡Øç*", confirmationNote: "_‡Æ§‡ÆØ‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ ‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øà ‡Æâ‡Æ±‡ØÅ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç._"
        },
        en: {
            loading: "Loading...", onlineOrder: "Online Order", loadingMenu: "Loading Menu...",
            items: "Items", continue: "Continue", completeOrder: "Complete Order",
            yourName: "Your Name", enterName: "Enter name", mobileNumber: "Mobile Number",
            enterMobile: "10 digit mobile number", address: "Address", enterAddress: "Room/Street name",
            placeOrderBtn: "Place Order via WhatsApp", linkError: "‚ùå Shop link is invalid. Please ensure you have added ?shopId=your_id at the end of the URL.",
            networkError: "‚ùå Connection Error. Check your Script URL and Deployment Access ('Anyone').",
            inactiveShop: "‚ö†Ô∏è This shop service is temporarily paused.", noItems: "No items available. Check MenuData JSON.",
            unavailableTitle: "‚ùå Temporarily Unavailable", soldOut: "SOLD OUT", add: "ADD",
            fillDetailsAlert: "‚ö†Ô∏è Please fill in all details: Name, Mobile Number, and Address.",
            submittingOrder: "Submitting Order...",
            orderMessageTitle: "*üí• New Order!* üõµ",
            customer: "*Customer*", mobile: "*Mobile*", orderDetails: "*Order Details:*",
            totalBill: "*Total Bill*", confirmationNote: "_Please confirm the order._"
        },
        hi: {
            loading: "‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...", onlineOrder: "‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§ë‡§∞‡•ç‡§°‡§∞", loadingMenu: "‡§Æ‡•á‡§®‡•ç‡§Ø‡•Ç ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...", 
            items: "‡§Ü‡§á‡§ü‡§Æ", continue: "‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•á‡§Ç", completeOrder: "‡§ë‡§∞‡•ç‡§°‡§∞ ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç", 
            yourName: "‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ", enterName: "‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç", mobileNumber: "‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞", 
            enterMobile: "10 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞", address: "‡§™‡§§‡§æ", enterAddress: "‡§ï‡§Æ‡§∞‡§æ ‡§®‡§Ç‡§¨‡§∞, ‡§ó‡§≤‡•Ä ‡§ï‡§æ ‡§®‡§æ‡§Æ",
            placeOrderBtn: "WhatsApp ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡§∞‡•á‡§Ç", linkError: "‚ùå ‡§¶‡•Å‡§ï‡§æ‡§® ‡§≤‡§ø‡§Ç‡§ï ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§®‡•á URL ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç ?shopId=your_id ‡§ú‡•ã‡§°‡§º‡§æ ‡§π‡•à‡•§",
            networkError: "‚ùå ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§ ‡§Ö‡§™‡§®‡•á ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü URL ‡§î‡§∞ ‡§°‡§ø‡§™‡•ç‡§≤‡•â‡§Ø‡§Æ‡•á‡§Ç‡§ü ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ('Anyone') ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç‡•§",
            inactiveShop: "‚ö†Ô∏è ‡§á‡§∏ ‡§¶‡•Å‡§ï‡§æ‡§® ‡§ï‡•Ä ‡§∏‡•á‡§µ‡§æ ‡§Ö‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡§Ç‡§¶ ‡§π‡•à‡•§", noItems: "‡§ï‡•ã‡§à ‡§Ü‡§á‡§ü‡§Æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ MenuData JSON ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç‡•§",
            unavailableTitle: "‚ùå ‡§Ö‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ö‡§®‡•Å‡§™‡§≤‡§¨‡•ç‡§ß", soldOut: "‡§¨‡§ø‡§ï ‡§ó‡§Ø‡§æ", add: "‡§ú‡•ã‡§°‡§º‡•á‡§Ç",
            fillDetailsAlert: "‚ö†Ô∏è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç: ‡§®‡§æ‡§Æ, ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§î‡§∞ ‡§™‡§§‡§æ‡•§",
            submittingOrder: "‡§ë‡§∞‡•ç‡§°‡§∞ ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
            orderMessageTitle: "*üí• ‡§®‡§Ø‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞!* üõµ",
            customer: "*‡§ó‡•ç‡§∞‡§æ‡§π‡§ï*", mobile: "*‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤*", orderDetails: "*‡§ë‡§∞‡•ç‡§°‡§∞ ‡§µ‡§ø‡§µ‡§∞‡§£:*",
            totalBill: "*‡§ï‡•Å‡§≤ ‡§¨‡§ø‡§≤*", confirmationNote: "_‡§ï‡•É‡§™‡§Ø‡§æ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç‡•§_"
        }
    };

    let currentLang = 'ta'; // Default to Tamil
    let menuItems = [];
    let ownerNumber = "";
    let shopName = ""; 

    // URL-‡Æ≤‡Øç ‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ Shop ID-‡Æê ‡Æé‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æ≤‡Øç
    const urlParams = new URLSearchParams(window.location.search);
    const SHOP_ID = urlParams.get('shopId');

    // ‡ÆÆ‡Øä‡Æ¥‡Æø ‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡Æ§‡Øç‡Æ§‡Øà ‡Æ®‡Æø‡Æï‡Æ¥‡Øç‡Æ§‡Øç‡Æ§‡ØÅ‡ÆÆ‡Øç ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Øç‡Æ™‡Ææ‡Æü‡ØÅ
    function translateUI() {
        const elements = document.querySelectorAll('[data-key]');
        elements.forEach(el => {
            const key = el.getAttribute('data-key');
            el.innerText = translations[currentLang][key] || el.innerText;
        });

        const placeholders = document.querySelectorAll('[data-key-placeholder]');
        placeholders.forEach(el => {
            const key = el.getAttribute('data-key-placeholder');
            el.placeholder = translations[currentLang][key] || el.placeholder;
        });
        
        // Cart ‡Æ™‡Æü‡Øç‡Æü‡Æ©‡Øà ‡ÆÆ‡Æ±‡ØÅ‡Æ™‡Æü‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ™‡Øç‡Æü‡Øá‡Æü‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡Æ≤‡Øç
        updateCartDisplay();
        
        // ‡ÆÆ‡ØÜ‡Æ©‡ØÅ‡Æµ‡Øà ‡ÆÆ‡Æ±‡ØÅ‡Æ™‡Æü‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æ∞‡ØÜ‡Æ£‡Øç‡Æü‡Æ∞‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡Æ≤‡Øç (ADD/SOLD OUT ‡Æ™‡Æü‡Øç‡Æü‡Æ©‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà ‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡ØÅ‡Æµ‡Æ§‡Æ±‡Øç‡Æï‡Ææ‡Æï)
        renderMenu(); 
    }
    
    // ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà ‡Æö‡ØÜ‡Æü‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Øç‡Æ™‡Ææ‡Æü‡ØÅ
    function setLanguage(lang) {
        currentLang = lang;
        translateUI();
        localStorage.setItem('quickOrderLang', lang);
    }


    // 1. ‡ÆÜ‡Æ∞‡ÆÆ‡Øç‡Æ™‡ÆÆ‡Øç (Initialization)
    window.onload = () => {
        // ‡Æö‡Øá‡ÆÆ‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà ‡Æè‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç
        const savedLang = localStorage.getItem('quickOrderLang') || 'ta';
        document.getElementById('languageSelector').value = savedLang;
        setLanguage(savedLang); 

        if (!SHOP_ID) {
            showError(translations[currentLang].linkError);
            return;
        }
        fetchShopData();
    };

    // 2. Google Sheet-‡Æ≤‡Øç ‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æü‡Øá‡Æü‡Øç‡Æü‡Ææ‡Æµ‡Øà ‡Æé‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æ≤‡Øç
    function fetchShopData() {
        fetch(`${scriptURL}?shopId=${SHOP_ID}`)
        .then(response => {
             if (!response.ok) throw new Error('Network response was not ok');
             return response.json();
        })
        .then(data => {
            if (data.status === "ACTIVE") {
                ownerNumber = data.ownerNumber;
                shopName = data.shopName; 
                menuItems = data.menu.map(item => ({...item, qty: 0}));
                
                document.getElementById('shopTitle').innerText = shopName || SHOP_ID.replace('_', ' ').toUpperCase(); 
                
                renderMenu();
            } else if (data.status === "INACTIVE") {
                showError(translations[currentLang].inactiveShop);
            } else {
                showError(translations[currentLang].networkError);
            }
        })
        .catch(error => {
            showError(`${translations[currentLang].networkError} <br><br> ${error.message}`);
        });
    }

    // 3. ‡ÆÆ‡ØÜ‡Æ©‡ØÅ‡Æµ‡Øà ‡Æ§‡Æø‡Æ∞‡Øà‡ÆØ‡Æø‡Æ≤‡Øç ‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç
    function renderMenu() {
        const container = document.getElementById('menuContainer');
        container.innerHTML = "";
        
        const availableItems = menuItems.filter(item => item.isAvailable !== false);
        const unavailableItems = menuItems.filter(item => item.isAvailable === false);

        if(availableItems.length === 0 && unavailableItems.length === 0) {
            container.innerHTML = `<div class='loading-screen' data-key='noItems'>${translations[currentLang].noItems}</div>`;
            return;
        }
        
        availableItems.forEach(item => {
            container.appendChild(createMenuItemCard(item, false)); 
        });
        
        if (unavailableItems.length > 0) {
             const title = document.createElement('h2');
             title.style.cssText = 'font-size: 16px; font-weight: 600; color: var(--unavailable); margin-top: 20px;';
             title.innerText = translations[currentLang].unavailableTitle;
             container.appendChild(title);
             
             unavailableItems.forEach(item => {
                container.appendChild(createMenuItemCard(item, true)); 
             });
        }
    }
    
    function createMenuItemCard(item, isUnavailable) {
        const card = document.createElement('div');
        card.className = "menu-card";
        if (isUnavailable) {
            card.classList.add('unavailable');
        }

        const currentQty = menuItems.find(i => i.id === item.id).qty;

        let controlsHTML;
        if (isUnavailable) {
            controlsHTML = `<div class="unavailable-tag">${translations[currentLang].soldOut}</div>`;
        } else if (currentQty === 0) {
            controlsHTML = `<button class="qty-btn" style="width:60px; color:green; border:1px solid #ddd; border-radius:5px; font-size:12px; font-weight:600;" onclick="updateQty(${item.id}, 1)">${translations[currentLang].add}</button>`;
        } else {
            controlsHTML = `
                <div class="qty-controls">
                    <button class="qty-btn" onclick="updateQty(${item.id}, -1)">-</button>
                    <div class="qty-val" id="qty-${item.id}">${currentQty}</div>
                    <button class="qty-btn" onclick="updateQty(${item.id}, 1)">+</button>
                </div>`;
        }

        // Image Fallback using onerror
        const imageUrl = item.imageUrl || `https://placehold.co/80x80/9e9e9e/ffffff?text=${item.name.substring(0,2)}`;

        card.innerHTML = `
            <img src="${imageUrl}" class="item-image" onerror="this.onerror=null;this.src='https://placehold.co/80x80/9e9e9e/ffffff?text=Food'">
            <div class="item-details">
                <span class="item-name">${item.name}</span>
                <span class="item-price">‚Çπ${item.price}</span>
            </div>
            <div class="add-btn-container">
                ${controlsHTML}
            </div>
        `;
        return card;
    }


    // 4. Quantity Update ‡Æ≤‡Ææ‡Æú‡Æø‡Æï‡Øç
    function updateQty(id, change) {
        const item = menuItems.find(i => i.id === id);
        if (item) {
            if (item.qty + change >= 0) {
                item.qty += change;
                renderMenu(); 
                updateCartDisplay();
            }
        }
    }

    // 5. Cart ‡Æ™‡Æü‡Øç‡Æü‡Æ©‡Øà ‡ÆÖ‡Æ™‡Øç‡Æü‡Øá‡Æü‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡Æ≤‡Øç
    function updateCartDisplay() {
        const cartItems = menuItems.filter(i => i.qty > 0);
        const total = cartItems.reduce((sum, i) => sum + (i.price * i.qty), 0);
        // FIXED: The syntax for the reduce function was corrected to calculate the total count.
        const count = cartItems.reduce((sum, i) => sum + i.qty, 0); 
        const langText = translations[currentLang].items;

        const cartBar = document.getElementById('floatingCart');
        if (count > 0) {
            cartBar.style.display = "flex";
            document.getElementById('itemCount').innerText = `${count} ${langText}`;
            document.getElementById('totalPrice').innerText = `‚Çπ${total}`;
        } else {
            cartBar.style.display = "none";
        }
        
        // Cart ‡Æ™‡Æü‡Øç‡Æü‡Æ©‡Æø‡Æ≤‡Øç ‡Æâ‡Æ≥‡Øç‡Æ≥ ‡Æ§‡Øä‡Æü‡Æ∞‡Æµ‡ØÅ‡ÆÆ‡Øç (Continue) ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ™‡Øç‡Æü‡Øá‡Æü‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç
        document.querySelector('.cart-arrow').innerText = translations[currentLang].continue + ' ‚Üí';
    }

    // 6. Checkout Modal ‡Æ§‡Æø‡Æ±‡Æ§‡Øç‡Æ§‡Æ≤‡Øç / ‡ÆÆ‡ØÇ‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç
    function openCheckout() {
        document.getElementById('checkoutModal').style.display = "flex";
    }
    function closeCheckout() {
        document.getElementById('checkoutModal').style.display = "none";
    }

    // 7. ‡ÆÜ‡Æ∞‡Øç‡Æü‡Æ∞‡Øç ‡Æö‡ÆÆ‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡Æø‡Æ§‡Øç‡Æ§‡Æ≤‡Øç
    function submitOrder() {
        const name = document.getElementById('cName').value.trim();
        const phone = document.getElementById('cPhone').value.trim();
        const address = document.getElementById('cAddress').value.trim();

        if (!name || !phone || !address) {
            customAlert(translations[currentLang].fillDetailsAlert);
            return;
        }

        const cartItems = menuItems.filter(i => i.qty > 0);
        const total = cartItems.reduce((sum, i) => sum + (i.price * i.qty), 0);
        
        // WhatsApp Message ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡Æ≤‡Øç
        let itemsListWA = cartItems.map(i => `* ${i.name} x ${i.qty}`).join("%0A");
        let itemsListSheet = cartItems.map(i => `${i.name} (${i.qty}) - ‚Çπ${i.price * i.qty}`).join(" | ");

        const t = translations[currentLang];

        // Order Message
        const msg = `${t.orderMessageTitle}%0A%0A*‡Æï‡Æü‡Øà:* ${shopName || SHOP_ID.toUpperCase()}%0A${t.customer}: ${name}%0A${t.mobile}: ${phone}%0A*‡ÆÆ‡ØÅ‡Æï‡Æµ‡Æ∞‡Æø:* ${address}%0A%0A${t.orderDetails}%0A${itemsListWA}%0A%0A${t.totalBill}: ‚Çπ${total}*%0A%0A${t.confirmationNote}`;
        
        const waLink = `https://wa.me/${ownerNumber}?text=${msg}`;

        // UI Feedback
        const btn = document.getElementById('placeOrderBtn');
        btn.innerText = translations[currentLang].submittingOrder;
        btn.disabled = true;

        // Google Sheet-‡Æï‡Øç‡Æï‡ØÅ ‡Æü‡Øá‡Æü‡Øç‡Æü‡Ææ‡Æµ‡Øà ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Øç‡Æ™‡ØÅ‡Æ§‡Æ≤‡Øç (Background)
        fetch(scriptURL, {
            method: 'POST',
            mode: 'no-cors', 
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                shopId: SHOP_ID,
                customerName: name,
                customerPhone: phone,
                address: address,
                orderDetails: itemsListSheet, 
                totalAmount: total.toFixed(2),
                whatsAppLink: waLink
            })
        }).then(() => {
            // Success ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ Failure ‡ÆÜ‡Æ©‡Ææ‡Æ≤‡ØÅ‡ÆÆ‡Øç, WhatsApp-‡Æï‡Øç‡Æï‡ØÅ Redirect ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡Æ≤‡Øç
            window.location.href = waLink;
        }).catch(err => {
            window.location.href = waLink;
        });
    }

    // Helper: ‡Æ™‡Æø‡Æ¥‡Øà ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡Æø‡ÆØ‡Øà‡Æï‡Øç ‡Æï‡Ææ‡Æü‡Øç‡Æü‡ØÅ‡Æ§‡Æ≤‡Øç
    function showError(msg) {
        document.getElementById('menuContainer').innerHTML = `<div class="loading-screen" style="color:red; text-align:center; font-weight:600; padding:20px;">${msg}</div>`;
    }
    
    // Custom Alert ‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡ØÅ (alert() ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Ææ‡ÆÆ‡Æ≤‡Øç)
    function customAlert(message) {
        const modal = document.createElement('div');
        modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:9999;display:flex;justify-content:center;align-items:center;';
        const box = document.createElement('div');
        box.style.cssText = 'background:white;padding:20px;border-radius:10px;max-width:300px;text-align:center;font-size:14px;box-shadow:0 5px 15px rgba(0,0,0,0.5);';
        box.innerHTML = `<p>${message}</p><button onclick="this.parentNode.parentNode.remove()" style="background:var(--primary-color);color:white;border:none;padding:8px 15px;border-radius:5px;margin-top:10px;">‡Æö‡Æ∞‡Æø (OK)</button>`;
        modal.appendChild(box);
        document.body.appendChild(modal);
    }
</script>

</body>
</html>

